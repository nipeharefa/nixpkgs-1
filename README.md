# Rin's Home üèö

> Heavily inspired from ([malob/nixpkgs](https://github.com/malob/nixpkgs)).

This is my personal configuration with [nix](https://nixos.org/) using [**flakes**](https://nixos.wiki/wiki/Flakes), [**home-manager**](https://github.com/nix-community/home-manager), & [**nix-darwin**](https://github.com/LnL7/nix-darwin) for Darwin or MacOS System.

## Structure

```console
.
‚îú‚îÄ‚îÄ darwin.nix (Nix Darwin configuration)
‚îú‚îÄ‚îÄ default.nix (Support legacy nix)
‚îú‚îÄ‚îÄ flake.lock
‚îú‚îÄ‚îÄ flake.nix (Flake configuration)
‚îú‚îÄ‚îÄ flake.nix.simple (Example: currently NOT USED)
‚îú‚îÄ‚îÄ home (home-manager)
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ activation.nix (Some script and configuration when activation the home manager)
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ packages.nix (list packages per user)
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ shells.nix (shell configuration, default Fish shell with startship)
‚îú‚îÄ‚îÄ nixpkgs.nix (Support legacy nix)
‚îú‚îÄ‚îÄ pkgs (modules for overlay in flake.nix, mostly generated by related tools like node2nix)
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ node-packages
‚îÇ¬†¬†     ‚îú‚îÄ‚îÄ README.md
‚îÇ¬†¬†     ‚îú‚îÄ‚îÄ default.nix
‚îÇ¬†¬†     ‚îú‚îÄ‚îÄ node-env.nix
‚îÇ¬†¬†     ‚îú‚îÄ‚îÄ node-packages.json
‚îÇ¬†¬†     ‚îî‚îÄ‚îÄ node-packages.nix
‚îî‚îÄ‚îÄ result -> /nix/store/xxxxxxx (the result when completed run nix build)

4 directories, 15 files

```

## Usage

### Prerequisite

#### **Nix**

| System                                         | Single User | Multiple User | Command                                                             |
| ---------------------------------------------- | ----------- | ------------- | ------------------------------------------------------------------- |
| **Linux**                                      | ‚úÖ          | ‚úÖ            | [Single User](#linux-single-user) ‚Ä¢ [Multi User](#linux-multi-user) |
| **Darwin** (MacOS)                             | ‚ùå          | ‚úÖ            | [Multi User](#darwin-multi-user)                                    |
| [**More...**](https://nixos.org/download.html) |             |               |                                                                     |

##### Linux Single User

```console
sh <(curl -L https://nixos.org/nix/install) --daemon
```

##### Linux Multi User

```console
sh <(curl -L https://nixos.org/nix/install) --no-daemon
```

##### Darwin Multi User

```console
sh <(curl -L https://nixos.org/nix/install)
```

#### Enable `experimental-features`

In general installation of nix, the nix configuration is located in `~/.config/nix/nix.conf`.
You **MUST** be set the `experimental-features` before use [this configuration](https://github.com/r17x/nixpkgs).

```cfg
experimental-features = nix-command flakes

// (optional) for distribution cache (DON'T COPY THIS COMMENT LINE)
substituters = https://cache.nixos.org https://cache.nixos.org/ https://r17.cachix.org
```

### Setup

- Clone [this repository](https://github.com/r17x/nixpkgs)

```console
// with SSH

git clone git@github.com:r17x/nixpkgs ~/.config/nixpkgs

// OR with HTTP
git clone https://github.com/r17x/nixpkgs ~/.config/nixpkgs

```

#### Build home-manager
-
#### Build Darwin System

Assume r17x/nixpkgs have been cloned. Then, you can run build for darwin system with this command

Machine Name:
* RG 
* eR17

**Build**

```console
// replace MACHINE_NAME 
// nix build ~/.config/nixpkgs#darwinConfigurations.[MACHINE_NAME].system

nix build ~/.config/nixpkgs#darwinConfigurations.eR17.system
```

every build have an output called "result" (directory) and need to apply

**Switch**

```console

// ./result/sw/bin/darwin-rebuild switch --flake .#[MACHINE_NAME]

./result/sw/bin/darwin-rebuild switch --flake .#eR17
```


## Command Tips
- 

## Acknowledgement

- [**malob/nixpkgs**](https://github.com/malob/nixpkgs) ~ [malob](https://github.com/malob) Nix System configs!.
